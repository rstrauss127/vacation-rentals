<section class="todoapp">

  <header class="header">
	   <h1><%= @listing.title %></h1>
	</header>

  <%= link_to "New Reservation", new_listing_reservation_path(@listing), class: 'new-todo' %><br>
  <%= link_to "View Reservations for this property", listing_reservations_path(@listing, @reservation), class: 'new-todo' %>

  <section class="main">
    <ul class="todo-list">
        <li>
          <div class="view">
            <label>Description: <%= @listing.description %></label>
            <label>Bedrooms: <%= @listing.bedrooms %></label>
            <label>Bathrooms: <%= @listing.bathrooms %></label>
          </div>
        </li>
    </ul>
  </section>
</section>

<div id="map"></div>

<%= render "partials/footer" %>

<button class="js-more" data-address="<%= @listing.address %>" data-city="<%= @listing.city %>" data-state="<%= @listing.state %>">Show map</button>

<script type="text/javascript" charset="utf-8">
  $(function() {
    $(".js-more").on("click", function() {
      var address = $(this).data("address");
      var city = $(this).data("city");
      var state = $(this).data("state");

      $.get(`https://maps.googleapis.com/maps/api/geocode/json?address=${address},+${city},+${state}&key=AIzaSyBhyxBrZNJeKGNZQuFdE6Phx_BDhkERGik`, function(data) {
        var cords = {lat: data.results[0].geometry.location.lat, lng: data.results[0].geometry.location.lng};

        var map = new google.maps.Map(document.getElementById('map'), {zoom: 14, center: cords});
        console.log("It worked !!");
      });

    });
  });
</script>

<script async defer
src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBhyxBrZNJeKGNZQuFdE6Phx_BDhkERGik&callback=initMap">
</script>
