<section class="todoapp">

  <header class="header">
    <h1>New listing</h1>
  </header>

    <%= form_for(@listing) do |f| %>
      <%= f.text_field :title, :class => "new-todo", :placeholder => (@listing.errors.full_messages_for(:title).first || "Enter a title for your Listing") %>
      <%= f.text_field :description, :class => "new-todo", :placeholder => (@listing.errors.full_messages_for(:description).first || "Enter a Description") %>
      <%= f.text_field :bedrooms, :class => "new-todo", :placeholder => (@listing.errors.full_messages_for(:bedrooms).first || "Enter the number of bedrooms") %>
      <%= f.text_field :bathrooms, :class => "new-todo", :placeholder => (@listing.errors.full_messages_for(:bathrooms).first || "Enter number of bathrooms") %>
      <%= f.text_field :address, :class => "new-todo", :placeholder => (@listing.errors.full_messages_for(:address).first || "Enter Address") %>
      <%= f.hidden_field :user_id, :value => current_user.id %>
      <%= f.submit :style => "display: none" %>
    <% end %>

    <div id="listing_results">
      <h2 id="listingTitle"></h2>
      <p id="listingAddress"></p>
    </div>
</section>
<%= render "partials/footer" %>

<script type="text/coffee" charset="utf-8">
  $(function () {
    $('form').submit(function(event) {
      //prevent form from submitting the default way
      event.preventDefault();

      var values = $(this).serialize();

      var listing = $.post('/listings', values);

      listing.done(function(data) {
        var listing = data;
        $("#listingtTitle").text(listing["title"]);
        $("#listingAddress").text(listing["address"]);
      });
    });
  });
</script>
